@tailwind base;
@tailwind components;
@tailwind utilities;

/* ============================================================================
   CSS VARIABLES - Single source of truth for colors
   ============================================================================ */

:root {
  /* Primary Brand - Base color for UI elements */
  --color-primary: #328cc1;
  /* Blue - base color for sections, borders, icons */

  /* Chart Palette - 5-color palette for data visualization only */
  --color-chart-1: #292866;
  /* Deep purple */
  --color-chart-2: #406352;
  /* Forest green */
  --color-chart-3: #F05C4F;
  /* Coral red */
  --color-chart-4: #C8C2E0;
  /* Lavender */
  --color-chart-5: #97D0B1;
  /* Mint green */

  /* Card Palette - Calm, moderate colors for UI cards */
  --color-card-1: #7B9CC4;
  /* Soft sky blue */
  --color-card-2: #6B9B8E;
  /* Sage green */
  --color-card-3: #9B86BD;
  /* Soft purple */
  --color-card-4: #5A8FAE;
  /* Ocean blue */
  --color-card-5: #8BA888;
  /* Muted green */
  --color-card-6: #8E7DAB;
  /* Dusty purple */

  /* Neutral Palette */
  --color-neutral-900: #0f172a;
  --color-neutral-800: #1e293b;
  --color-neutral-700: #334155;
  --color-neutral-600: #475569;
  --color-neutral-500: #64748b;
  --color-neutral-400: #94a3b8;
  --color-neutral-300: #cbd5e1;
  --color-neutral-200: #e2e8f0;
  --color-neutral-100: #f1f5f9;
  --color-neutral-50: #f8fafc;

  /* Chart Colors */
  --color-chart-grid: #e2e8f0;
  --color-chart-axis: #64748b;

  /* Typography */
  --font-sans: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;

  /* Shadcn compatibility */
  --radius: 0.5rem;
  --background: 0 0% 100%;
  --foreground: 222.2 84% 4.9%;
  --border: 214.3 31.8% 91.4%;
  --input: 214.3 31.8% 91.4%;
  --ring: 221.2 83.2% 53.3%;
}

/* ============================================================================
   BASE STYLES
   ============================================================================ */

@layer base {
  * {
    @apply border-neutral-200;
  }

  body {
    @apply bg-neutral-100 text-neutral-700 antialiased m-0 p-0 overflow-hidden h-screen;
    font-family: var(--font-sans);
    font-size: 13px;
  }

  /* Custom Scrollbar Styling */
  ::-webkit-scrollbar {
    width: 12px;
    height: 12px;
  }

  ::-webkit-scrollbar-track {
    @apply bg-neutral-100;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-neutral-300 rounded-full border-[3px] border-neutral-100 transition-colors duration-150;
  }

  ::-webkit-scrollbar-thumb:hover {
    @apply bg-neutral-400;
  }
}

/* ============================================================================
   LAYOUT COMPONENTS
   ============================================================================ */

@layer components {

  /* Main App Shell */
  .app-shell {
    @apply flex h-screen w-screen overflow-hidden bg-neutral-100;
  }

  /* Sidebar */
  .sidebar {
    @apply w-64 flex flex-col shrink-0 border-r border-neutral-300 bg-neutral-100;
  }

  .sidebar-header {
    @apply h-14 px-5 flex items-center gap-3 border-b border-neutral-200 bg-neutral-100;
  }

  .sidebar-nav {
    @apply flex-1 py-3 overflow-y-auto;
  }

  .sidebar-title {
    @apply text-sm font-bold px-0 mb-0 text-neutral-900;
  }

  /* Navigation Sidebar Buttons */
  .nav-item {
    @apply px-5 py-2.5 flex items-center gap-3 w-full transition-all duration-150 text-left;
  }

  .nav-item-label {
    @apply text-sm font-bold text-neutral-700;
  }

  .nav-item-icon {
    @apply w-4 h-4 text-primary;
  }

  .nav-item-active {
    @apply bg-neutral-200/50;
  }

  .nav-item-active .nav-item-label {
    @apply text-neutral-900;
  }

  .nav-item-active .nav-item-icon {
    @apply text-primary;
  }

  .nav-item:not(.nav-item-active):hover {
    @apply bg-neutral-200/30;
  }

  /* Main Content Area */
  .main-content {
    @apply flex-1 flex flex-col min-w-0 bg-neutral-100;
  }

  /* View Container */
  .view-container {
    @apply h-full flex flex-col bg-neutral-100;
  }

  /* View Header */
  .view-header {
    @apply h-14 bg-neutral-100 border-b border-neutral-200 px-6 flex items-center justify-between shrink-0;
  }

  .view-header-title {
    @apply text-sm font-bold uppercase tracking-wide text-neutral-900;
  }

  .view-header-content {
    @apply flex items-center gap-3;
  }

  .view-header-icon {
    @apply w-4 h-4 text-primary;
  }

  /* Scrollable Content */
  .view-content {
    @apply flex-1 overflow-y-auto;
  }

  .content-wrapper {
    @apply w-full px-8 py-6 flex flex-col;
  }

  .view-section {
    @apply mt-8 first:mt-0;
  }

  /* Ensure last child of section removes bottom margin */
  .view-section>*:last-child {
    @apply mb-0 !important;
  }

  .layout-grid-2 {
    @apply grid grid-cols-1 md:grid-cols-2 gap-6 mb-6;
  }

  .layout-grid-2:last-child {
    @apply mb-0;
  }

  /* Cards inside grid should not have bottom margin - grid handles spacing */
  .layout-grid-2>.card {
    @apply mb-0;
  }

  /* HEADINGS AND TEXT */
  /* ============================================================================ */
  .heading-section {
    @apply text-sm font-bold uppercase tracking-wide text-neutral-900 pb-2 mb-4 border-b border-neutral-200 flex items-center justify-between;
  }

  .table_title {
    @apply text-[10px] uppercase tracking-wider text-neutral-500 mt-6 mb-4 px-2 block first:mt-0;
  }

  .table-footnote {
    @apply text-xs text-neutral-500 mt-4 italic text-left;
  }

  .list-standard {
    @apply list-disc list-inside space-y-2 text_body ml-4;
  }

  .text_body {
    @apply text-sm leading-relaxed text-neutral-600 font-normal;
  }

  .text-block {
    @apply space-y-4 mb-6;
  }

  .text-block:last-child {
    @apply mb-0;
  }

  /* TYPOGRAPHY UTILITIES */
  /* ============================================================================ */
  .legend-label {
    @apply text-[10px] uppercase tracking-wider text-neutral-600;
  }

  .formula-systematic {
    @apply text-primary;
  }

  .formula-idiosyncratic {
    @apply text-neutral-400;
  }

  .formula-hma {
    @apply text-orange-500;
  }

  /* CARDS */
  /* ============================================================================ */
  .card {
    @apply rounded-xl overflow-hidden transition-all duration-200 mb-6;
    background-color: rgba(148, 163, 184, 0.03);
  }

  .card:last-child {
    @apply mb-0;
  }

  .mb-card-gap {
    @apply mb-6;
  }

  .card-body {
    @apply p-6;
  }

  /* Card Variants */
  .card-v1 {
    --card-theme-color: var(--color-card-1);
    border: 1px solid var(--color-card-1) !important;
    background-color: rgba(123, 156, 196, 0.03);
  }

  .card-v2 {
    --card-theme-color: var(--color-card-2);
    border: 1px solid var(--color-card-2) !important;
    background-color: rgba(107, 155, 142, 0.03);
  }

  .card-v3 {
    --card-theme-color: var(--color-card-3);
    border: 1px solid var(--color-card-3) !important;
    background-color: rgba(155, 134, 189, 0.03);
  }

  .card-v4 {
    --card-theme-color: var(--color-card-4);
    border: 1px solid var(--color-card-4) !important;
    background-color: rgba(90, 143, 174, 0.03);
  }

  .card-v5 {
    --card-theme-color: var(--color-card-5);
    border: 1px solid var(--color-card-5) !important;
    background-color: rgba(139, 168, 136, 0.03);
  }

  .card-v6 {
    --card-theme-color: var(--color-card-6);
    border: 1px solid var(--color-card-6) !important;
    background-color: rgba(142, 125, 171, 0.03);
  }

  /* Card Content */
  .card .card-title-large {
    @apply text-lg font-bold uppercase tracking-tight;
    color: var(--card-theme-color);
  }

  .card .card-subtitle {
    @apply text-xs font-semibold text-neutral-600 mt-1 uppercase tracking-wider;
  }

  .card .card-description {
    @apply text-sm text-neutral-700 mt-4 leading-relaxed;
  }

  .card .card-stat-value {
    @apply text-xl font-bold text-center block w-full;
    @apply mt-6;
    color: var(--card-theme-color);
  }

  .card-body>.card-stat-value:first-child {
    @apply mt-0;
  }

  /* LEGEND DOTS */
  /* ============================================================================ */
  .legend-dot-systematic {
    @apply w-2 h-2 rounded-full bg-primary;
  }

  .legend-dot-idiosyncratic {
    @apply w-2 h-2 rounded-full bg-neutral-400;
  }

  .legend-dot-hma {
    @apply w-2 h-2 rounded-full bg-orange-500;
  }

  .legend-container {
    @apply flex justify-center gap-6 mt-6;
  }

  .legend-item {
    @apply flex items-center gap-2;
  }

  /* TABLES */
  /* ============================================================================ */
  .table-container {
    @apply mb-6;
  }

  .table {
    @apply w-full text-left border-collapse mb-6;
    border: 1px solid #e2e8f0;
  }

  .table:last-child {
    @apply mb-0;
  }

  .table th {
    @apply px-4 py-3 text-xs font-bold uppercase tracking-wider border border-neutral-300 text-neutral-700;
    background-color: rgba(148, 163, 184, 0.15);
  }

  .table td {
    @apply px-4 py-2.5 text-xs font-normal text-neutral-700 border border-neutral-200;
  }

  .text_table_right {
    @apply text-right;
  }

  .text_table_left {
    @apply text-left;
  }

  .text_table_header_right {
    @apply text-right text-neutral-900;
  }

  .text_table_header_left {
    @apply text-left text-neutral-900;
  }

  /* INTERACTIVE ELEMENTS */
  /* ============================================================================ */
  .active-scale-sm {
    @apply active:scale-[0.98];
  }

  /* BUTTONS - EXACT SFT STANDARDS (DO NOT MODIFY) */
  .btn {
    @apply inline-flex items-center justify-center gap-2 rounded-lg font-semibold text-sm transition-all duration-150 active-scale-sm;
  }

  .btn-primary {
    @apply btn px-5 py-2.5 bg-primary text-white hover:bg-primary-600;
  }

  .btn-secondary {
    @apply btn px-5 py-2.5 bg-neutral-100 border border-neutral-200 text-neutral-700 hover:bg-neutral-200 hover:border-neutral-300;
  }

  .btn-ghost {
    @apply btn px-4 py-2 text-neutral-500 hover:text-neutral-900 hover:bg-neutral-200;
  }

  .nav-btn {
    @apply btn px-6 py-2.5 bg-neutral-100 border border-neutral-200 text-neutral-700 hover:border-primary hover:text-primary shadow-sm;
  }

  .nav-btn-hidden {
    @apply invisible;
  }

  .footer-nav {
    @apply flex items-center justify-between mt-6 pt-6 border-t border-neutral-200;
  }

  /* FLOW DIAGRAMS */
  /* Individual node styling */
  .flow-node {
    @apply flex items-center justify-center text-center font-semibold border-2 rounded-lg;
    font-size: 10px;
    /* Dimensions are now handled in JS constants */
    box-sizing: border-box;
    border-color: #7B9CC4;
    background-color: rgba(123, 156, 196, 0.03);
    color: #7B9CC4;
  }

  .flow-container {
    @apply w-full h-full;
  }

  .card-body-large {
    height: 400px;
  }

  .card-body-compact {
    height: 250px;
  }

  /* UTILITIES */
  /* ============================================================================ */
  .mb-0 {
    margin-bottom: 0 !important;
  }

  /* ============================================================================
     PROGRESS INDICATOR
     ============================================================================ */
  .progress-indicator {
    @apply p-4 border-t border-neutral-200 bg-neutral-50;
  }

  .progress-indicator .progress-header {
    @apply flex items-center gap-2 mb-2;
  }

  .progress-indicator .progress-icon {
    @apply text-primary;
  }

  .progress-indicator .progress-text {
    @apply text-xs font-medium text-neutral-600;
  }

  .progress-indicator .progress-bar-container {
    @apply h-2 bg-neutral-200 rounded-full overflow-hidden;
  }

  .progress-indicator .progress-bar-fill {
    @apply h-full bg-primary rounded-full transition-all duration-300;
  }

  .progress-indicator .progress-footer {
    @apply flex items-center justify-between mt-2;
  }

  .progress-indicator .progress-percentage {
    @apply text-xs font-bold text-neutral-700;
  }

  .progress-indicator .assessment-badge {
    @apply text-xs font-semibold px-2 py-0.5 rounded;
  }

  .progress-indicator .assessment-badge.passed {
    @apply bg-green-100 text-green-700;
  }

  .progress-indicator .assessment-badge.failed {
    @apply bg-red-100 text-red-700;
  }

  /* ============================================================================
     ASSESSMENT STYLES
     ============================================================================ */

  /* Assessment Intro */
  .assessment-intro {
    @apply text-center max-w-2xl mx-auto py-8;
  }

  .assessment-intro h2 {
    @apply text-2xl font-bold text-neutral-900 mb-4;
  }

  .assessment-intro .intro-text {
    @apply text-neutral-600 mb-6 leading-relaxed;
  }

  .assessment-intro .assessment-info {
    @apply text-left bg-neutral-50 rounded-lg p-6 mb-8 space-y-2;
  }

  .assessment-intro .assessment-info li {
    @apply text-sm text-neutral-600 flex items-start gap-2;
  }

  .assessment-intro .assessment-info li::before {
    content: "â€¢";
    @apply text-primary font-bold;
  }

  .assessment-intro .previous-result {
    @apply mb-6 p-4 rounded-lg text-sm font-medium;
  }

  .assessment-intro .previous-result.passed {
    @apply bg-green-50 text-green-700 border border-green-200;
  }

  .assessment-intro .previous-result.failed {
    @apply bg-amber-50 text-amber-700 border border-amber-200;
  }

  .start-assessment-button {
    @apply inline-flex items-center gap-2 px-8 py-3 bg-primary text-white font-semibold rounded-lg hover:bg-primary/90 transition-colors;
  }

  /* Assessment Progress Dots */
  .assessment-progress {
    @apply flex items-center justify-center gap-2 mb-8 flex-wrap;
  }

  .assessment-progress .progress-dot {
    @apply w-8 h-8 rounded-full text-xs font-semibold flex items-center justify-center transition-all;
    @apply bg-neutral-100 text-neutral-400 border-2 border-neutral-200;
  }

  .assessment-progress .progress-dot:hover {
    @apply border-neutral-400;
  }

  .assessment-progress .progress-dot.current {
    @apply bg-primary text-white border-primary;
  }

  .assessment-progress .progress-dot.answered {
    @apply bg-green-100 text-green-700 border-green-300;
  }

  .assessment-progress .progress-dot.answered.current {
    @apply bg-primary text-white border-primary;
  }

  /* Question Container */
  .question-container {
    @apply bg-white rounded-xl border border-neutral-200 p-8 mb-6;
  }

  .question-header {
    @apply flex items-center gap-4 mb-6 pb-4 border-b border-neutral-100 flex-wrap;
  }

  .question-header .question-number {
    @apply text-sm font-bold text-neutral-900;
  }

  .question-header .question-module {
    @apply text-xs font-medium px-2 py-1 bg-neutral-100 text-neutral-600 rounded;
  }

  .question-header .question-points {
    @apply text-xs font-medium text-primary ml-auto;
  }

  .question-text {
    @apply text-lg font-medium text-neutral-800 mb-8 leading-relaxed;
  }

  /* Question Options */
  .question-options {
    @apply space-y-3;
  }

  .question-options.true-false {
    @apply flex gap-4;
  }

  .question-options.true-false .option-button {
    @apply flex-1 justify-center;
  }

  .option-button {
    @apply w-full flex items-center gap-4 p-4 rounded-lg border-2 border-neutral-200 text-left transition-all;
    @apply hover:border-primary/50 hover:bg-primary/5;
  }

  .option-button.selected {
    @apply border-primary bg-primary/10;
  }

  .option-button .option-letter {
    @apply w-8 h-8 rounded-full bg-neutral-100 text-neutral-600 font-bold text-sm flex items-center justify-center;
  }

  .option-button.selected .option-letter {
    @apply bg-primary text-white;
  }

  .option-button .option-text {
    @apply text-neutral-700 font-medium;
  }

  /* Question Input */
  .question-input {
    @apply max-w-md;
  }

  .question-input .numeric-input,
  .question-input .text-input {
    @apply w-full px-4 py-3 text-lg border-2 border-neutral-200 rounded-lg focus:border-primary focus:outline-none;
  }

  .question-input .input-unit {
    @apply ml-3 text-neutral-500;
  }

  .question-input .input-hint {
    @apply mt-2 text-xs text-neutral-400;
  }

  .answer-saved {
    @apply mt-4 text-sm text-green-600 font-medium;
  }

  /* Assessment Navigation */
  .assessment-navigation {
    @apply flex items-center justify-between gap-4;
  }

  .assessment-navigation .nav-button {
    @apply inline-flex items-center gap-2 px-6 py-3 rounded-lg font-semibold transition-all;
  }

  .assessment-navigation .nav-button.prev {
    @apply bg-neutral-100 text-neutral-700 hover:bg-neutral-200;
  }

  .assessment-navigation .nav-button.next {
    @apply bg-primary text-white hover:bg-primary/90;
  }

  .assessment-navigation .nav-button.submit {
    @apply bg-green-600 text-white hover:bg-green-700;
  }

  .assessment-navigation .nav-button:disabled {
    @apply opacity-50 cursor-not-allowed;
  }

  .assessment-navigation .answer-count {
    @apply text-sm text-neutral-500;
  }

  /* Assessment Results */
  .assessment-results {
    @apply max-w-2xl mx-auto py-8;
  }

  .assessment-results .result-header {
    @apply text-center mb-8;
  }

  .assessment-results .result-header.passed {
    @apply text-green-600;
  }

  .assessment-results .result-header.failed {
    @apply text-red-600;
  }

  .assessment-results .result-header h2 {
    @apply text-2xl font-bold mt-4 mb-2;
  }

  .assessment-results .result-header p {
    @apply text-neutral-600;
  }

  .assessment-results .result-score {
    @apply flex justify-center mb-8;
  }

  .assessment-results .score-circle {
    @apply w-40 h-40 rounded-full border-4 border-neutral-200 flex flex-col items-center justify-center;
  }

  .assessment-results .result-header.passed + .result-score .score-circle {
    @apply border-green-200 bg-green-50;
  }

  .assessment-results .result-header.failed + .result-score .score-circle {
    @apply border-red-200 bg-red-50;
  }

  .assessment-results .score-value {
    @apply text-4xl font-bold text-neutral-900;
  }

  .assessment-results .score-label {
    @apply text-sm text-neutral-500 mt-1;
  }

  .assessment-results .result-breakdown {
    @apply bg-neutral-50 rounded-xl p-6;
  }

  .assessment-results .result-breakdown h3 {
    @apply text-lg font-bold text-neutral-900 mb-4;
  }

  .assessment-results .review-list {
    @apply space-y-2;
  }

  .assessment-results .review-item {
    @apply flex items-center gap-4 p-3 bg-white rounded-lg border;
  }

  .assessment-results .review-item.correct {
    @apply border-green-200;
  }

  .assessment-results .review-item.incorrect {
    @apply border-red-200;
  }

  .assessment-results .review-item .review-number {
    @apply text-sm font-bold text-neutral-700 w-8;
  }

  .assessment-results .review-item .review-module {
    @apply text-xs font-medium px-2 py-0.5 bg-neutral-100 text-neutral-500 rounded;
  }

  .assessment-results .review-item .review-status {
    @apply ml-auto;
  }

  .assessment-results .review-item.correct .review-status {
    @apply text-green-600;
  }

  .assessment-results .review-item.incorrect .review-status {
    @apply text-red-600;
  }

  .assessment-results .review-item .review-points {
    @apply text-sm font-medium text-neutral-600 w-20 text-right;
  }

  .retry-button {
    @apply mt-8 mx-auto flex items-center gap-2 px-8 py-3 bg-primary text-white font-semibold rounded-lg hover:bg-primary/90 transition-colors;
  }

  .completion-message {
    @apply mt-8 p-6 bg-green-50 rounded-xl border border-green-200 text-center;
  }

  .completion-message p {
    @apply text-green-700 font-medium;
  }
}